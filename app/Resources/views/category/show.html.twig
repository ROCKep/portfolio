{% extends 'base.html.twig' %}

{% block title %}Материалы{% endblock %}
{% block header %}Материалы{% endblock %}
{% block body %}
    <ol class="breadcrumb">
        {% for breadcrumb in breadcrumbs %}
            {% if breadcrumb.id == category.id %}
                <li class="active">{{ breadcrumb.name }}</li>
            {% else %}
                <li>
                    <a href="{{ path('cat_show', {'id': breadcrumb.id}) }}">{{ breadcrumb.name }}</a>
                </li>
            {% endif %}
        {% endfor %}
    </ol>
    {% if category.children|length == 0 and category.materials|length == 0 %}
        <p>Пусто</p>
    {% else %}
        <table class="table table-hover">
            <thead>
                <tr>
                    <th>Название</th>
                    <th>Дата создания</th>
                    <th>Права доступа</th>
                    <th>Действия</th>
                </tr>
            </thead>
            {% for c in category.children %}
                <tr>
                    <td>
                        <span class="glyphicon glyphicon-folder-open"></span>
                        <a href="{{ path('cat_show', {'id': c.id}) }}">{{ c.name }}</a>
                    </td>
                    <td>
                        <span>{{ c.createdDate|date('d.m.Y') }}</span>
                    </td>
                    <td>
                        <span>
                            {% if c.restriction is not null %}
                                {{ c.restriction.name }}
                            {% else %}
                                Видно всем
                            {% endif %}
                        </span>
                    </td>
                    <td>
                        <span class="actions">
                            <a href="{{ path('cat_edit', {'id': c.id}) }}">Изменить</a>
                            <a href="{{ path('cat_delete', {'id': c.id}) }}">Удалить</a>
                        </span>
                    </td>
                </tr>
            {% endfor %}
            {% for m in category.materials %}
                <tr>
                    <td>
                        <span class="glyphicon glyphicon-file"></span>
                        <a href="#">{{ m.name }}</a>
                    </td>
                    <td>
                        <span>{{ m.date|date('d.m.Y') }}</span>
                    </td>
                    <td>
                        <span>{% if m.restriction is not null %}{{ m.restriction.name }}{% endif %}</span>
                    </td>
                    <td>
                        <span class="actions">
                            <a href="#">Изменить</a>
                            <a href="#">Удалить</a>
                        </span>
                    </td>
                </tr>
            {% endfor %}
        </table>
    {% endif %}
    <p><a href="{{ path('cat_new', {'id': category.id}) }}">Добавить подкатегорию</a></p>
    <p><a href="{{ path('material_new', {'cat_id': category.id}) }}">Добавить материал</a></p>
{% endblock %}